name: Passing Variables between jobs

on:
  workflow_dispatch:

jobs: 
  producer:
    runs-on: ubuntu-24.04
    
    # Map step output to job output
    outputs:
      foo: ${{ steps.generate-foo.outputs.foo }}

    steps:
      - name: Generate and export foo
        id: generate-foo 
        run: |
          foo=bar
          # 1) Step output (for job output)
          echo "foo=${foo}" >> "$GITHUB_OUTPUT"

          # 2) Job-scoped environment variable
          echo "FOO=${foo}" >> "$GITHUB_ENV"

      - name: Inspect values inside producer
        run: |
          # Bash sees the env variable set via GITHUB_ENV
          echo "FOO {set via GITHUB_ENV}: $FOO"

          # Access step output via GitHub Actions expression
          echo "foo {step output}: ${{ steps.generate-foo.outputs.foo }}"

  consumer:
    runs-on: ubuntu-24.04
    needs: producer

    steps:
      - name: Inspect values inside consumer
        run: |
          # Access job output from producer
          echo "Value from producer (job output): ${{ needs.producer.outputs.foo }}"

          # Bash env variable FOO from producer is NOT available here
          echo "FOO in consumer (bash env): ${FOO:-<UNSET>}"
